# Digispot-BackupDJin
 Скрипт для резервного копирования конфигураций Джина по всему комплексу
================================================================
Скрипт можно запустить без параметров, в этом случае он возьмёт пути к Джинам на рабочих местах из списка `Digispot-BackupDJin.csv`.
В этот файл нужно поместить полный сетевой путь к папке с установленным Джином, МАГом, Медиапланером, DDB и проч. ПО Дигиспот - по одному в каждой строке:
```
\\server1\c$\Program Files (x86)\Digispot II\AMPV_Europa_main\Djin
\\server1\c$\Program Files (x86)\Digispot II\AMPV_Retro_main\Djin
\\workstation2\c$\Program Files (x86)\Digispot II\Special Station\Mag
```
Для доступа по сети к установленному на рабочих местах ПО Дигиспот используется администраторский ресурс `c$`. Если он недоступен, и на чтение расшарена папка Digispot II в виде:
`\\workstation3\Digispot II\DJin`, то нужно в строке
```
$array[$n].path = [string]::Join('\', $array[$n].UNC.Split('\')[6..$($array[$n].UNC.Split('\').Length)])
```
значение 6 поменять на 4 (содержимое папки Digispot II находится после 6-го слэша `\` в случае с `c$`, и после 4-го `\` во втором случае).

Также можно запустить скрипт с параметром в виде имени .csv-файла:

`Digispot-BackupDJin.ps1 .\myradiostation1.csv`

В этом случае можно разнести резервное копирование разных серверов и рабочих станций по разным конфигурационным файлам и разным компьютерам, где будет выполняться скрипт.

Путь к папке назначения где будут храниться резервные копии указывается в скрипте в переменной `$dstPath`, например:

`$dstPath = "\\STORAGE\Share\backups"`

При выполнении скрипта в этой папке будет создана папка с именем компьютера, в ней папка с текущей датой, в ней структура папок внутри `Digispot II`. Резервное копирование выполняется для папки SYSTEM с конфигурацией ПО Дигиспот, а также для лицензий рабочего места, это описано в переменной `$include = @('KeyDll*.dll', '*.info', '*.ini')`

Результат работы скрипта сохраняется в лог-файл в .\log\


История версий
==============

v1.00 2022-12-23 Первая версия.

Roman Ermakov <r.ermakov@emg.fm>
